---
scenarios:
  scenario_0:
    script: multiple_inference_and_scaling.jmx

services:
  - module: shellexec
    prepare:
      - "curl -s -X POST http://localhost:8081/models?url=${SQZNET_URL}"
      - "curl -s -X POST http://localhost:8081/models?url=${RESNET_URL}"
      - "curl -s -X PUT  http://localhost:8081/models/${SQZNET_NAME}?min_worker=1&synchronous=true"
      - "curl -s -X PUT  http://localhost:8081/models/${RESNET_NAME}?min_worker=1&synchronous=true"


reporting:
- module: passfail
  criteria:
    # Inbuilt Criteria
    - success of Inference2<${INFR2_SUCC} for 10s, stop as failed
    - avg-rt of Inference2>${INFR2_RT} for 10s, ${STOP_ALIAS} as failed
    - success of Inference11<${INFR1_SUCC} for 10s, stop as failed
    - success of Inference21<${INFR2_SUCC} for 10s, stop as failed
    - avg-rt of Inference11>${INFR1_RT} for 10s, ${STOP_ALIAS} as failed
    - avg-rt of Inference21>${INFR2_RT} for 10s, ${STOP_ALIAS} as failed
    - success of ScaleUp1<${INFR2_SUCC} for 10s, stop as failed
    - avg-rt of ScaleUp1>${SCALEUP1_RT} for 10s, ${STOP_ALIAS} as failed
    - success of ScaleUp2<${INFR2_SUCC} for 10s, stop as failed
    - avg-rt of ScaleUp2>${SCALEUP2_RT}  for 10s, ${STOP_ALIAS} as failed
    - success of ScaleDown1<${INFR2_SUCC} for 10s, stop as failed
    - avg-rt of ScaleDown1>${SCALEDOWN1_RT}  for 10s, ${STOP_ALIAS} as failed
    - success of ScaleDown2<${INFR2_SUCC} for 10s, stop as failed
    - avg-rt of ScaleDown2>${SCALEDOWN2_RT}  for 10s, ${STOP_ALIAS} as failed

